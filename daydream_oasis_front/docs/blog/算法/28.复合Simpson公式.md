
<BlogInfo id="1151" title="28.复合Simpson公式" author="白日梦想猿" pv=0 read_times=0 pre_cost_time="0分27秒" category="算法" tag_list="['算法']" create_time="2021.12.15 10:14:07" update_time="2021.12.15 10:35:04" />

```python
from math import sin


# 定义simpson公式（5.20的公式）
def simpson(a, b, N, f):
    h = (b - a) / N

    # x_n
    def x_n(n):
        return a + n * h

    re1 = 0
    re2 = 0
    for i in range(N):
        if i == 0:
            re1 += f(x_n(i + 1 / 2))
        else:
            re1 += f(x_n(i + 1 / 2))
            re2 += f(x_n(i))
    return h / 6 * (f(a) + 4 * re1 + 2 * re2 + f(b))


# 定义f(x)
def f(x):
    if x == 0:
        return 1
    f = sin(x) / x
    return f


if __name__ == '__main__':
    a = 0
    b = 1
    N = 4
    print(simpson(a, b, N, f))

```
