
<BlogInfo title="数据处理之seaborn的学习" author="白日梦想猿" pv=0 read_times=0 pre_cost_time=556 category="seaborn" tag_list="['seaborn', '数据处理', '绘图']" create_time="2021.08.28 18:04:49.383012" update_time="2021.08.28 18:08:06" />

^^^^^^^^^
<p><span style="font-size: 24px;">1.什么是seaborn?</span></p><pre><br>#学习seaborn的原因<br>'''<br>Matplotlib虽然已经是比较优秀的绘图库了,但是它有个令人头疼的问题,那就是API使用<br>过于复杂,它里面有上千个函数和参数,属于典型的那种可以用它做任何事,却无从下手.<br><br>seaborn基于Matplotlib核心库进行了更高级的API封装,可以轻松地画出更漂亮的图形,<br>而seaborn的漂亮主要体现在配色更加舒服,以及图形元素的样式更加细腻<br><br>'''<br><br>#安装:pip install seaborn<br><br>#可视化数据的分布<br>'''<br>当处理一组数据时,通常先要做的就是了解变量是如何分布的.<br>    .对于单变量的数据来说,采用直方图或核密度曲线是一个不错的选择<br>    .对于双变量来说,可采用多面板图形展示<br><br>针对这种情况,seaborn库提供了对单变量和双变量分布的绘制函数,如displot()函数,joinplot()<br>函数<br><br>'''<br></pre><h2><a></a>2.单变量分布的图形绘制</h2><pre>import seaborn as san<br>import numpy as np<br>import matplotlib.pyplot as plt<br><br>'''<br>可以采用最简单的直方图描述单变量的分布情况.seaborn中提供了displot()函数,它默认<br>绘制的是一个带有核密度估计曲线的直方图<br>API:seaborn.displot(a,bins=None,hist=True,kde=True,rug=False,fit=None,color=None)<br>参数:<br>    a:数据,可以是series,一维数组等<br>    bins:用于控制条形的数量<br>    hist:是否绘制直方图<br>    kde:是否绘制高斯密度估计曲线<br>    rug:是否在支持的轴方向上绘制rugplot<br><br><br>'''<br><br>#核密度估计<br>'''<br>核密度估计是在概率论中用来估计未知的密度函数,属于非参数检验方法之一,可以比较直观地看出<br>数据样本本身的分布特征<br><br>'''<br><br>np.random.seed(0)<br>list_=np.random.randn(100)<br><br>san.displot(list_,bins=20,kde=True,rug=True,color='deepskyblue')<br><br>plt.show()<br><br></pre><p><img src="https://img-blog.csdnimg.cn/4a2d0d2044be4a2d8cf5b54ffcd05811.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_16,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2><a></a>3.双变量分布的图形绘制</h2><pre>import numpy as np<br>import seaborn as sns<br>import pandas as pd<br>import matplotlib.pyplot as plt<br>#双变量分布<br>'''<br>两个变量的二元分布可视化也很有用,在seaborn中最简单的方法是使用joinplot()函数,<br>该函数可以创建一个多面板图形,比如散点图,二维直方图等,以显示两个变量之间的关系,以及<br>每个变量在单坐标轴上的单变量分布<br>API:seaborn.jointplot(x,y,data=None,kind="scatter",stat_func=None,color=None,<br>    ratio=5,space=0.2,dropna=True)<br>    参数:<br>        data:数据,可以是DataFrame<br>        kind:表示绘制图形的类型<br>        stat_func:用于计算有关关系的统计量并标注图<br>        color:绘图元素的颜色<br>        height:用于设置图的大小(正方形)<br>        ratio:表示中心图与侧边图的比例.该参数值越大,则中心图的占比越大<br>        space:用于设置中心图与侧边图的间隔大小<br><br><br>'''<br><br><br>#绘制散点图<br>df=pd.DataFrame({'x':np.random.randn(1000),'y':np.random.randn(1000)})<br>sns.jointplot(x='x',y='y',data=df,kind='scatter',color='deepskyblue',height=10,ratio=5,space=0.5,dropna=True,)<br># plt.show()<br><br>#绘制成对的双变量分布图<br># dataset=sns.load_dataset('iris')<br># sns.pairplot(dataset)<br>plt.show()</pre><p><img src="https://img-blog.csdnimg.cn/ce22f48138a4480991f71b9a748bc0f2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2><a></a>4.NBA球员数据分析</h2><pre>import numpy as np<br>import pandas as pd<br>import seaborn as sns<br>import matplotlib.pyplot as plt<br><br>data=pd.read_csv('nba_2017_nba_players_with_salary.csv')<br>print(data.head())<br><br>#相关性 求任意两组数据之间的相关性<br>corr=data.corr()<br>print(corr.head())<br><br>#绘制相关性的热力图<br><br><br>plt.figure(figsize=(50,50))<br>sns.heatmap(corr,square=True,linewidths=0.1,annot=True)<br>plt.savefig('NBA球员数据分析之相关性.png')<br>plt.show()<br><br><br>print(data.columns.values)<br>#获取球员的效率排行榜<br>rpm_list=data.loc[:,['PLAYER','AGE','SALARY_MILLIONS','RPM']].sort_values(by='RPM',ascending=False)<br>print(rpm_list.head(10))<br><br>#获取球员的薪资排行榜<br>rpm_list=data.loc[:,['PLAYER','AGE','SALARY_MILLIONS','RPM']].sort_values(by='SALARY_MILLIONS',ascending=False)<br>print(rpm_list.head(10))<br><br><br>#获取球员的年龄 薪水 效率值的分布情况<br><br>#年龄<br>plt.figure(figsize=(100,50))<br>sns.set_theme(style='darkgrid')<br>sns.displot(data['AGE'],kde=True,kind='hist',height=100)<br>plt.show()<br>print(data['AGE'])<br># age_min=data['AGE'].min()<br># age_max=data['AGE'].max()<br># age_bins=np.linspace(age_min,age_max,30)<br># plt.xticks(age_bins)<br># plt.ylabel('AGE')<br><br><br>#薪水<br>plt.subplot(3,1,2)<br>sns.displot(data['SALARY_MILLIONS'],kde=True)<br>salary_min=data['SALARY_MILLIONS'].min()<br>salary_max=data['SALARY_MILLIONS'].max()<br>salary_bins=np.linspace(salary_min,salary_max,30)<br>plt.xticks(salary_bins)<br>plt.ylabel('SALARY_MILLIONS')<br>#效率<br>plt.subplot(3,1,3)<br>sns.displot(data['RPM'],kde=True)<br>rpm_min=data['RPM'].min()<br>rpm_max=data['RPM'].max()<br>rpm_bins=np.linspace(rpm_min,rpm_max,30)<br>plt.xticks(rpm_bins)<br>plt.ylabel('RPM')<br><br><br>#查看各个变量之间的相关性<br># sns.pairplot(data)<br>plt.show()<br></pre><p><img src="https://img-blog.csdnimg.cn/3e8ba0260a5347ee8182056725f8ab11.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/6c7fbdbc75a0491fa552a4a7554c063d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_16,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2><a></a>5.NBA球员数据分析之延伸变量</h2><pre>import pandas as pd<br>import seaborn as sns<br>import matplotlib.pyplot as plt<br>import numpy as np<br># 读取数据<br>data = pd.read_csv('nba_2017_nba_players_with_salary.csv')<br>print(data.columns.values)<br><br># 对年龄进行一个划分<br>def cut_age(x):<br>    if x &lt; 25:<br>        return 'young'<br>    elif x &gt; 30:<br>        return 'old'<br>    else:<br>        return 'best'<br><br><br>data['age_cut'] = data['AGE'].apply(lambda x: cut_age(x))<br>print(data.head())<br><br>#绘制各个年龄段薪资关于效率的散点图<br>plt.figure(figsize=(10,10),)<br>sns.set_theme(style='darkgrid')<br>plt.title('the correlation between RPM and SALARY in different age group')<br>plt.xlabel('RPM')<br>plt.ylabel('SALARY')<br>rpm_max=data['RPM'].max()<br>rpm_min=data['RPM'].min()<br>salary_max=data['SALARY_MILLIONS'].max()<br>salary_min=data['SALARY_MILLIONS'].min()<br>plt.xticks(np.linspace(rpm_min,rpm_max,10))<br>plt.yticks(np.linspace(salary_min,salary_max,10))<br><br>#young<br>young_rpm=data[data.age_cut=='young'].RPM<br>young_salary=data[data.age_cut=='young'].SALARY_MILLIONS<br>plt.scatter(young_rpm,young_salary,marker='o',label='young')<br><br>#old<br>old_rpm=data[data.age_cut=='old'].RPM<br>old_salary=data[data.age_cut=='old'].SALARY_MILLIONS<br>plt.scatter(old_rpm,old_salary,marker='^',color='green',label='old')<br><br>#best<br>best_rpm=data[data.age_cut=='best'].RPM<br>best_salary=data[data.age_cut=='best'].SALARY_MILLIONS<br>plt.scatter(best_rpm,best_salary,marker='x',color='red',label='best')<br>plt.legend()<br><br><br>sns.pairplot(data.loc[:,['WINS_RPM' ,'PIE', 'PACE','SALARY_MILLIONS','age_cut']],hue='age_cut')<br><br><br>plt.show()</pre><p><img src="https://img-blog.csdnimg.cn/1a7c919c26d341879e952dc08f72965e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2><a></a>6.NBA球队数据分析之箱线图和小提琴图的应用</h2><pre>import numpy as np<br>import pandas as pd<br>import matplotlib.pyplot as plt<br>import seaborn as sns<br><br>data = pd.read_csv('nba_2017_nba_players_with_salary.csv')<br><br><br># print(data.columns.values)<br><br># 对年龄进行一个划分<br>def cut_age(x):<br>    if x &lt; 25:<br>        return 'young'<br>    elif x &gt; 30:<br>        return 'old'<br>    else:<br>        return 'best'<br><br><br>data['age_cut'] = data['AGE'].apply(lambda x: cut_age(x))<br><br># 按照不同球队的平均薪资进行降序排序<br>'''<br>agg({'SALARY_MILLIONS': np.mean,'RPM':np.mean})<br>计算不同球队下薪资和效率的平均值<br><br>'''<br>data2 = data.groupby(by=['TEAM'], as_index=True).agg({'SALARY_MILLIONS': np.mean, 'RPM': np.mean}).sort_values(<br>    by=['SALARY_MILLIONS'], ascending=False)<br># print(data2)<br><br><br># 按照分球队分年龄段,上榜球员数降序排列,如果上榜球员数相同,则按照效率值降序排列<br>data3 = data.groupby(by=['TEAM', 'age_cut']).agg(<br>    {'PLAYER': np.size, 'RPM': np.mean, 'SALARY_MILLIONS': np.mean, }).sort_values(<br>    by=['PLAYER', 'RPM', 'SALARY_MILLIONS'], ascending=False)<br># print(data3)<br><br># 按照球队的平均效率值降序排序<br>data4 = data.groupby(by=['TEAM']).agg({'RPM': np.mean, 'SALARY_MILLIONS': np.mean}).sort_values(by=['RPM'],<br>                                                                                                ascending=False)<br># print(data4)<br><br># 利用箱线图和小提琴图进行数据分析<br># 去特定的几组球队<br>team = ['GS', 'CLE', 'SA', 'LAC', 'OKC', 'UTAH', 'CHA', 'TOR', 'NO', 'BOS']<br>data5 = data[data.TEAM.isin(team)]<br><br>plt.figure(figsize=(40, 20))<br>sns.set_style('whitegrid')<br><br># 年龄<br>plt.subplot(3, 2, 1)<br>sns.boxplot(x='TEAM', y='AGE', data=data5)<br><br># 薪资<br>plt.subplot(3, 2, 3)<br>sns.boxplot(x='TEAM', y='SALARY_MILLIONS', data=data5)<br><br>#RPM<br>plt.subplot(3, 2, 5)<br>sns.boxplot(x='TEAM', y='RPM', data=data5)<br><br><br><br>#3分球命中率<br>plt.subplot(3,2,2)<br>sns.violinplot(x='TEAM',y='3P%',data=data5)<br><br>#命中率<br>plt.subplot(3,2,4)<br>sns.violinplot(x='TEAM',y='FG%',data=data5)<br><br>#犯规<br>plt.subplot(3,2,6)<br>sns.violinplot(x='TEAM',y='PF',data=data5)<br>plt.show()<br></pre><p><img src="https://img-blog.csdnimg.cn/134077b30d0a456c90eea50ddbb44f80.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2><a></a>7.房源信息处理之数据预处理</h2><pre>import pandas as pd<br>import matplotlib.pyplot as plt<br>import seaborn as sns<br>import numpy as np<br><br><br># 预处理<br>class Preprocessing:<br>    data = None<br><br>    # 数据读取<br>    @classmethod<br>    def readData(cls):<br>        Preprocessing.data = pd.read_csv('链家北京租房数据.csv')<br><br>    # 重复值和空值的处理<br>    # 删除重复值<br>    @classmethod<br>    def deleteDupAndNa(cla):<br>        data = Preprocessing.data<br><br>        # 重复值检测<br>        isDup = np.all(data.duplicated().values)  # 如果有重复值返回True,否则False<br><br>        # 删除重复值<br>        if isDup:<br>            data.drop_duplicates()<br><br>        # 空值检测<br>        isNan = np.all(data.isna().values)<br>        if isNan:<br>            data.dropna()<br><br>    #数据类型的转换<br>    @classmethod<br>    def transformType(cls):<br><br>        #将面积转换成浮点型数据<br>        newArr=[]<br>        for i in Preprocessing.data['面积(㎡)']:<br>            newArr.append(i[:-2])<br>        newArr=np.array(newArr).astype(np.float64)<br>        Preprocessing.data.loc[:,['面积(㎡)']]=newArr<br><br>        #房屋类型的替换<br>        newArr2=[]<br>        for i in Preprocessing.data['户型']:<br>            newArr2.append(i.replace('房间','室'))<br>        Preprocessing.data['户型']=newArr2<br><br>    #返回预处理完成的数据<br>    @classmethod<br>    def returnDoneData(cls):<br>        Preprocessing.readData()<br>        Preprocessing.deleteDupAndNa()<br>        Preprocessing.transformType()<br>        return Preprocessing.data<br><br><br>if __name__ == '__main__':<br>    Preprocessing.readData()<br>    Preprocessing.deleteDupAndNa()<br>    Preprocessing.transformType()<br></pre><h2><a></a>8.房源信息处理之房源数量位置分析</h2><pre>import pandas as pd<br>import numpy as np<br>import matplotlib.pyplot as plt<br>from lll07_链家北京租房数据处理之数据预处理 import Preprocessing<br><br>plt.rcParams['font.sans-serif'] = ['SimHei']  # 黑体<br><br><br><br>#获取预处理完成的数据<br>data=Preprocessing.returnDoneData()<br><br><br>#统计各个地区的房源数量<br>area=data['区域'].unique()<br><br><br><br>area_num=data.groupby(by='区域').agg({'户型':np.size}).sort_values(by='户型',ascending=False)<br>df=pd.DataFrame({'区域':area,'数量':area_num['户型']})<br><br>plt.figure(figsize=(20,8))<br>plt.bar(df['区域'],df['数量'],color=['red','green','yellow','blue','purple','pink','orange','skyblue','deeppink','deepskyblue','black','gray'])<br>plt.xlabel('区域',fontsize=16)<br>plt.ylabel('房屋数量/间',fontsize=16)<br>plt.title('北京各区域房源数量直方图',fontsize=20)<br>plt.xticks(fontsize=16)<br>plt.yticks(fontsize=16)<br><br><br><br>plt.show()<br><br><br></pre><p><img src="https://img-blog.csdnimg.cn/a35309fcf5c64801b732ae896da91974.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2><a></a>9.房源信息处理之户型数量分析</h2><pre>import pandas as pd<br>import numpy as np<br>import matplotlib.pyplot as plt<br>from lll07_链家北京租房数据处理之数据预处理 import Preprocessing<br><br>plt.rcParams['font.sans-serif'] = ['SimHei']  # 用来正确显示中文<br># 获取预处理完成的数据<br>data = Preprocessing.returnDoneData()<br><br>data_house = data['户型']<br><br><br>def all_house(arr):  # 获取每个户型的数量<br>    key = np.unique(arr)<br>    result = {}<br>    for k in key:<br>        arr_new = arr[arr == k]<br>        v = arr_new.size<br>        result[k] = v<br>    return result<br><br><br>data = all_house(data_house)<br># 筛选出大于50的数据<br>data = {key: value for key, value in data.items() if value &gt; 50}<br># print(data)<br><br>df = pd.DataFrame({'户型': data.keys(), '数量': data.values()}).sort_values(by='数量', ascending=True)<br><br>plt.figure(figsize=(15, 8))<br>plt.barh(df['户型'], df['数量'])<br>plt.xlabel('数量', fontsize=16)<br>plt.ylabel('户型', fontsize=16)<br>plt.title('北京市各户型数量统计', fontsize=20)<br>plt.grid()<br><br># 给柱头添加数量<br>for x, y in enumerate(df['数量']):<br>    print(x, y)<br>    plt.text(y + 10, x - 0.1, f'{y}', fontsize=14)<br><br>plt.show()<br></pre><p><img src="https://img-blog.csdnimg.cn/d786330965d8449b86eb522ece63c49e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2><a></a>10.房源信息处理之平均租金分析</h2><pre>import numpy as np<br>import matplotlib.pyplot as plt<br>from lll07_链家北京租房数据处理之数据预处理 import Preprocessing<br><br>plt.rcParams['font.sans-serif'] = ['SimHei']  # 用来正确显示中文<br># 获取预处理完成的数据<br>data = Preprocessing.returnDoneData()<br><br># 统计各个区域的租金的平均值<br>data_rent = data.groupby(by=['区域']).agg({'价格(元/月)': np.sum, '面积(㎡)': np.sum, '区域': np.size})<br>data_rent['平均价格'] = round(np.divide(data_rent['价格(元/月)'], data_rent['面积(㎡)']), 2)<br>data_rent = data_rent  # .sort_values(by='平均价格',ascending=False)<br>data_rent['数量'] = data_rent['区域']<br>print(data_rent)<br><br># 绘制图形<br>x = [i for i in range(data_rent['平均价格'].values.size)]<br>num = data_rent['数量'].values<br>price = data_rent['平均价格'].values<br><br>fig = plt.figure(figsize=(10, 8))<br>ax1 = fig.add_subplot(111)<br>ax1.plot(x, price, 'or-', label='平均价格')  # 绘制折线图<br>ax1.set_ylim([0, 160])<br>plt.xlabel('区域', fontsize=16)<br>plt.ylabel('平均价格', fontsize=16)<br>plt.legend(loc='upper right')<br># 在拐点处显示数量<br>for i, (x_, y_) in enumerate(zip(x, price)):<br>    plt.text(x_ + 0.1, y_, price[i], fontsize=16)<br><br># 绘制柱状图<br>ax2 = ax1.twinx()<br>plt.bar(x, num, alpha=0.2, color='green', label='数量')<br>plt.xticks(x, data_rent.index.values, fontsize=16)<br>plt.legend(loc='upper left')<br><br>plt.show()<br></pre><p><img src="https://img-blog.csdnimg.cn/f99e702b92eb4ffd9b98bfc42e16cfa7.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><h2><a></a>11.房源信息处理之面积划分</h2><pre>import pandas as pd<br>import matplotlib.pyplot as plt<br>from lll07_链家北京租房数据处理之数据预处理 import Preprocessing<br><br>plt.rcParams['font.sans-serif'] = ['SimHei']  # 用来正确显示中文<br># 获取预处理完成的数据<br>data = Preprocessing.returnDoneData()<br><br># 统计各面积块的占比<br>area_divide = [1, 30, 50, 70, 90, 120, 140, 160, 1200]<br>data_area = pd.cut(data['面积(㎡)'], area_divide)<br><br>num_list = []<br>labels = []<br>for index in data_area.value_counts().index.values:<br>    num_list.append(data_area.value_counts().loc[index])<br>    str_index = str(index).replace('(', '').replace(']', '').split(',')<br>    label = f'{str_index[0]}-{str_index[1]}平米'<br>    labels.append(label)<br>plt.figure(figsize=(10, 10))<br>plt.pie(num_list, labels=labels, autopct='%.2f%%')<br>plt.legend()<br><br>plt.show()<br></pre><p><img src="https://img-blog.csdnimg.cn/8ca4a840f1e742738858b838c4c5880d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAbGl0dGxl5Lqu772e,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p><br><br><br><p data-we-empty-p="">​附件​(新增附件不会覆盖原有的)<br></p><hr><p data-we-empty-p="" class="CFP"><a href="http://www.lll.plus/static/file/2021/08/28/nba_2017_nba_players_with_salary.csv" target="_blank">nba_2017_nba_players_with_salary.csv</a><br></p><p data-we-empty-p="" class="CFP"><a href="http://www.lll.plus/static/file/2021/08/28/链家北京租房数据.csv" target="_blank">链家北京租房数据.csv</a><br></p>
