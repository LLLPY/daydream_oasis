
<BlogInfo id="1148" title="2.子类化collections中的类" author="白日梦想猿" pv=0 read_times=0 pre_cost_time=0分31秒 category="继承的优缺点" tag_list="['继承的优缺点']" create_time="2022.04.07 15:15:13" update_time="2022.09.05 14:08:23" />

```python
# 如果不子类化dict类(c语言编写的)，而是子类化collections.UserDict(python编写的)，
# 那么就不会出现内置方法忽略用户覆盖的方法

'''
如果子类化使用python编写的类，如UserDict或MutableMapping，就不会受到影响。
'''

from collections import UserDict


class DoppelDict(UserDict):

    # 覆盖父类的__setitem__方法
    def __setitem__(self, key, value):
        super().__setitem__(key, value * 2)

    # 在__getitem__找不到键的情况下会调用__missing__方法，如果该方法存在的话
    def __missing__(self, key):
        self[key] = 0
        return 0


if __name__ == '__main__':
    dd = DoppelDict(one=1)
    print(dd)

    dd['two'] = 2
    print(dd)

    dd.update(three=3)
    print(dd)

    # 可以看到无论使用那种方式，都是调用我们覆盖的__setitem__方法

```
