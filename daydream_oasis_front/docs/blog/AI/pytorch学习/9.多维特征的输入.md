
<BlogInfo id="18" title="9.多维特征的输入" author="白日梦想猿" pv=0 read_times=0 pre_cost_time="0分57秒" category="人工智能" tag_list="['人工智能']" create_time="2021.07.17 15:45:31" update_time="2021.07.31 18:19:38" />

```python
import numpy as np
import torch

# 导入数据集
xy = np.loadtxt('diabetes.csv.gz', delimiter=',', dtype=np.float32)
x_data = torch.from_numpy(xy[:, :-1])
y_data = torch.from_numpy(xy[:, [-1]])
print(x_data)

# 模型建立
class Model(torch.nn.Module):

    def __init__(self):
        super(Model, self).__init__()
        self.linear1 = torch.nn.Linear(8, 6)
        self.linear2 = torch.nn.Linear(6, 4)
        self.linear3 = torch.nn.Linear(4, 1)
        self.activate = torch.nn.Sigmoid()

    def forward(self, x):
        x = self.activate(self.linear1(x))
        x = self.activate(self.linear2(x))
        y_pred = self.activate(self.linear3(x))
        return y_pred


model = Model()

criterion = torch.nn.BCELoss(size_average=False)  # 损失函数
optimizer = torch.optim.SGD(model.parameters(), lr=0.01)  # 优化函数

# 训练
for epoch in range(1000):
    # 前馈forward
    y_pred = model(x_data)
    loss = criterion(y_pred, y_data)

    # 反馈backward
    optimizer.zero_grad()
    loss.backward()

    # 更新update
    optimizer.step()

# 测试
x_test = torch.Tensor([[-0.8824, -0.1457,  0.0820, 0.1 ,0.4, -0.2072, -0.7669, -0.6667]])
y_test=model(x_test)
print(y_test.item())

```
